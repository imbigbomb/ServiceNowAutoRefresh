# 工单自动监控与提醒系统

[English Version](README.md) | 简体中文

![预览图](img/1.png)

这是一个基于 Python 开发的桌面自动化工具，专为客服、运维或技术支持人员设计。它能自动循环刷新浏览器中的工单页面，通过图像识别技术监测新工单，并播放报警音提醒。

---

### 🌟 核心功能

* **双页面自动刷新**：支持同时监控两个不同的浏览器窗口（如 Incidents 和 Catalog Tasks）。
* **智能图像识别**：通过屏幕扫描识别“Open”和“New”等状态标签，支持模糊匹配提高准确率。
* **多媒体报警**：检测到新工单时播放自定义 `.wav` 音频，并支持系统蜂鸣音备份。
* **实时可视化日志**：带时间戳的 GUI 日志界面，每一轮扫描结果清晰可见。
* **持久化设置**：内置设置菜单，可直接修改 URL 和监控间隔，设置自动保存至 `config.ini`。
* **后台静默运行**：支持以 `.pyw` 方式运行，无黑色 CMD 窗口干扰。

---

### 📂 文件结构说明

请确保以下文件位于同一文件夹内：

| 文件名 | 说明 |
| --- | --- |
| `main.py` (或 `.pyw`) | 主程序代码 |
| `config.ini` | 配置文件（程序运行后自动生成） |
| `alert.wav` | 报警提示音（需准备） |
| `open_label.png` | “Open”状态的截图（需准备） |
| `new_label.png` | “New”状态的截图（需准备） |
| `requirements.txt` | 依赖库列表 |

---

### 🛠 安装与配置

#### 1. 安装环境

确保您的电脑已安装 Python 3.x。在项目目录下运行以下命令安装必要的依赖库：

```bash
pip install pyautogui pygetwindow pygame opencv-python pillow

```

#### 2. 准备素材

* **截图**：使用截图工具截取工单系统中“Open”和“New”标签的小图，分别命名为 `open_label.png` 和 `new_label.png`。
* **音频**：准备一个短促的报警音，命名为 `alert.wav`。

#### 3. 配置参数

启动程序后，点击 **⚙ 设置** 按钮：

* **URL 1 / 2**：填入您的工单系统访问地址。
* **间隔 (秒)**：建议设置在 `120` 秒以上，以给页面留出足够的加载时间。

---

### 🚀 使用指南

1. **打开浏览器**：在 Chrome 或 Edge 中打开工单页面，确保窗口标题包含配置中的关键词（如 "Incidents"）。
2. **启动监控**：运行脚本后，点击界面上的 **“开始监控”**。
3. **自动运行**：
* 程序会自动激活对应的浏览器窗口并按 `F5` 刷新。
* 等待 20 秒页面加载。
* 全屏扫描是否有匹配的标签。
* 若发现目标，触发报警音并在日志输出。


4. **快捷操作**：点击 **“打开网页”** 按钮可一键唤起预设的工单页面。

---

### ⚠️ 注意事项

* **窗口标题**：程序通过窗口标题匹配浏览器。如果浏览器标签页被遮挡或标题改变，请在代码顶部的 `WINDOW_TITLE` 处修改。
* **缩放比例**：请保持系统显示缩放（Windows Settings）为 100% 或在截图时保持一致，否则图像识别可能失效。
* **插值报错**：本版本已处理 URL 中 `%` 字符引起的 `interpolation` 报错。
